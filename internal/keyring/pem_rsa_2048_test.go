package keyring

import (
	"testing"
)

func TestPEMRSA2048(t *testing.T) {
	testCase := &pemKeyTest{
		privateKey: `-----BEGIN PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCviijPp18pZlOV
RfLHA12GaR/kqrlUMU1xnStmR6/Yp2t6mqKIUIxcih0QX0CV8q6zo7BOAskx4OE1
Ib7aTY5dzQSUKKO2m1rov4X2l7xAQPC9o9Y53OEsm4LIa95BHhUsrJ2JcgnyM9Bj
0dqG/7D384fL1DZhVYpehLaZS4WBY/U9TayQ66NPhCCczBolyohgwwl/vqqOscWM
v4EQiMkbC/GyKbw12hknwhKPbPB8T3LK6wghV0OYlV5caSIL2wEpR5HQGvohfhOB
QbwRx8Be+lTpY2mSK7Fi5YL0UL7WtItap8BtfGhV/o45gzXPkMG4J0KuVSvM50GO
lYKkuQNfAgMBAAECggEADMa/ha2m7Xp3Juw6aWXDTt8j5R7P8mLMQjKwT/dzww8c
cYYDwmwqaynaR7DHIKLTOFv3nxXw0uKNQbK9E2KFtCoR5T63+7h++2XFOFd+6iZP
312nX/rFoNuIv1GqkY7A98lwhep48tn2lu1VPHIrzUA6aAmAE8GIGq0KJUor42jm
F0fDbubotl4EeHHBXr9dkxz4/YIGc40jyxNOqKY2PBOeDqtFnWXHHv3b4uAIZ2n0
AKMaBorC9xm3Cx0XAe24WvxtcXuj2wn38uxMcf2XsD/0/FBB4MNVME3qzE1s5oeX
UE7MY7J5ScRe3btL4EeNp/ISJzLNYcWbiJYlIhqgAQKBgQDpELt4z52l393OlW89
P983XooyjGd1UBaRmft+fur3IwbWMl3CZ0RphGc8FfeOeFmq5xjIk00ytvFbt/6f
E1xVqZ4dCo2iZ1ib8rPpc+OheHDFuLznSvSm/UU9j2NS3fiWOSjN6fvA5r5clOYT
LQrcXwgxLk1UbflGUHietMoYAQKBgQDA0ETGBTseiPEycl27RkTRksa7+6iSb65z
loDwN2f/JHczNJbUGHcspSCBo26NTVwa1IUk9EosQoeqXcfjhRFilB8TNOkLX6uV
/iv2/Rjyr5l8f7EEh/tdEPwXw5ZOdMo96T642MogmxASnfM9tOiK47VxZElJOaFh
M+7bjTIbXwKBgQCMtbRpsPcd4TWZ9rBtSzWpySMod4oy0oJ9r3ieG2Qihvwmr8vZ
hd1Q00Y8iYqnclO4kcNtvTj7aGX5mPFZ+ydg9IHoSKnQJhLiPDqQtI32u69iQDGU
drWUaA64puwxaKAfmizffOeow+akIKVzaFtJRvq8LpczZR39bLIWJ1JoAQKBgEbU
e18vDr+x2MEKaEpijudZ/u2RjiR1KGXH1QfpoqeEstE5sWqqriTVaDKXYgZAc+Rb
S6n+n7zQl9vK5aI8AN3wwdWhazbFZ1gLbgUmhuKoBT9J/TJH7dwLYEAulmmt15mU
tHjdEquVqvrb0T5K1d4ntkC4cX+XzyPRGx7GKLELAoGAOBIL+RnChHiWsE/9cnp+
7VWbu3IdPKV8DBb6wxOx4yOR2megqtxko1O25+trk6rDfSwN+Y1UqVgo8ranLqkz
TbxVfS7x2am/aITAa7BBZIb6IefLL7FnDGuDFamL/zmj8KCadLIdHscMk63hhAYc
lnEut6dcpwJ3Vi02HkIVHJU=
-----END PRIVATE KEY-----`,

		publicKey: `-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAr4ooz6dfKWZTlUXyxwNd
hmkf5Kq5VDFNcZ0rZkev2KdrepqiiFCMXIodEF9AlfKus6OwTgLJMeDhNSG+2k2O
Xc0ElCijtpta6L+F9pe8QEDwvaPWOdzhLJuCyGveQR4VLKydiXIJ8jPQY9Hahv+w
9/OHy9Q2YVWKXoS2mUuFgWP1PU2skOujT4QgnMwaJcqIYMMJf76qjrHFjL+BEIjJ
Gwvxsim8NdoZJ8ISj2zwfE9yyusIIVdDmJVeXGkiC9sBKUeR0Br6IX4TgUG8EcfA
XvpU6WNpkiuxYuWC9FC+1rSLWqfAbXxoVf6OOYM1z5DBuCdCrlUrzOdBjpWCpLkD
XwIDAQAB
-----END PUBLIC KEY-----`,

		keyTest: keyTest{
			jwaSignatureAlgorithm: "PS512",

			jwkThumbprintSHA256:  "v4r0qw06dgzwHrQyltf5sgK84c7-O63Sz1E-au1fdqM",
			sshFingerprintSHA256: "SHA256:29Rip4JSaQAYxQ3wTQ3uoaDLo4GfTPHlnlksQCFixnk",
		},
	}

	testCase.run(t)
}
