package keyring

import (
	"testing"
)

func TestSSHRSA2048(t *testing.T) {
	testCase := &sshKeyTest{
		privateKey: `-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn
NhAAAAAwEAAQAAAQEAxHLKFyqz5LOaxvz+cr9Bz3oivSbvq5bbhz2ZtzLmG3Fm8BkSfbel
Lu7IhFR3911Vs2tPG7eqxN8QVUsN9bBhA6BOMMlRBMPlEN1lj9Jxn/6O1c2fNEv+xe6iwu
dsgiDvE10keybU9kSezfIxnAyxnmvmC4Qf6dRNwHSTQpiFSACLfa/gYeTcrz9GvaOJ0MzU
cbu4TMgEuCkWhAf6Xu+68JUpBVEyD6KQ5lCrQqAMq7nbAFlp33qabeJJhHhtNjH1DLpSDT
loGaFQHNerXY1Wsc38gCI6uH+CFPHrd3+KAcJ48vOGV8WqpFDF7LLG6mcgI8p/aKi2O5ZN
etFXer9A0wAAA9DoIxt06CMbdAAAAAdzc2gtcnNhAAABAQDEcsoXKrPks5rG/P5yv0HPei
K9Ju+rltuHPZm3MuYbcWbwGRJ9t6Uu7siEVHf3XVWza08bt6rE3xBVSw31sGEDoE4wyVEE
w+UQ3WWP0nGf/o7VzZ80S/7F7qLC52yCIO8TXSR7JtT2RJ7N8jGcDLGea+YLhB/p1E3AdJ
NCmIVIAIt9r+Bh5NyvP0a9o4nQzNRxu7hMyAS4KRaEB/pe77rwlSkFUTIPopDmUKtCoAyr
udsAWWnfeppt4kmEeG02MfUMulINOWgZoVAc16tdjVaxzfyAIjq4f4IU8et3f4oBwnjy84
ZXxaqkUMXsssbqZyAjyn9oqLY7lk160Vd6v0DTAAAAAwEAAQAAAQA7sa/kI0c/zy3Qmq8N
Gj36uF/W/35jszcpHNhZWV+f5jFD8zJxvjy1Cr0mrO45XgS9PPXwc7qyESBK8sAesMaCDh
PEcmAqpQY1vjju36FEX1ty74UZpKAZ8D5IIH+R+UT8qth7jZy36rkg1qApjZfpjlr8k90I
tkkcGrBm06bobi2mqtLDEmQdbeIsls2Fs69Szr5bD2BCHSy6eyEU/QQNPJAyy/i703ZsD4
leYI+EoJ08LKq7FBlEoHEeQ+B9asetIFaI8e8qtziYVLx3Gg5EWbbICoH7+RBDgLQXEmSr
Z07qYYli3xN+RwiVWab+DPzOwo8O4Fb3fqWvbmawAYbRAAAAgHIa3PeCUthWLOkAAlnkPa
DD8G2C798hyBtKFV2KXd/wDVZhG1ruk7WT7iTmMNCj5rI2LCNH1FMUhqn2a7YY1HJyoYug
zzQdUVVkmGE2XXk57dd1nqLXIDrIIyk+DpaA8sQs11iDNlq+/2xkIMgD6O46jFqOb34XKS
S4wAa+UhkzAAAAgQDjtnSld1Ubgs7Hr6JBLXNsJrKu2XISBmQWQlL3Iqr3ILjzdoSWMoBD
Q/4lxkRUrFHPQULa3wks+WSgUJV5icDITi1B7G65pgJiJu2hL6rMnGLwJYghHP3dzuTs0x
HZNXzIiMpFJGPsTNqIS7L3g4uZ+qjbk5vDzfg/IVc8A842kQAAAIEA3NoXBMXEyQllmA7V
ntZAkJs5QPXzsy9EUy6WUG8xN+onTWE9NiA4syfhIpztXeHMvZJd8ybKpjuD103nr4Tvcq
NPqmjdCXGKLXnshfzFtRj5CTUlNAMDjqg8wY71/rovgp3RxFDls41Cb+MIOcsP6Opp7qEu
oQUXoSVKitxEmyMAAAAUcnNhLTIwNDhAZXhhbXBsZS5jb20BAgMEBQYH
-----END OPENSSH PRIVATE KEY-----`,

		publicKey: `ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDEcsoXKrPks5rG/P5yv0HPeiK9Ju+rltuHPZm3MuYbcWbwGRJ9t6Uu7siEVHf3XVWza08bt6rE3xBVSw31sGEDoE4wyVEEw+UQ3WWP0nGf/o7VzZ80S/7F7qLC52yCIO8TXSR7JtT2RJ7N8jGcDLGea+YLhB/p1E3AdJNCmIVIAIt9r+Bh5NyvP0a9o4nQzNRxu7hMyAS4KRaEB/pe77rwlSkFUTIPopDmUKtCoAyrudsAWWnfeppt4kmEeG02MfUMulINOWgZoVAc16tdjVaxzfyAIjq4f4IU8et3f4oBwnjy84ZXxaqkUMXsssbqZyAjyn9oqLY7lk160Vd6v0DT`,

		keyTest: keyTest{
			jwaSignatureAlgorithm: "PS512",

			jwkThumbprintSHA256:  "CVf5d5PxVx1e1qQDVsEDlmMFEA1XIqkkUqpdlM9Xbdg",
			sshFingerprintSHA256: "SHA256:AAcpUEnMqioXI1QxSW+Habr1rj+v19tpOwzb570kDbg",
			comment:              "rsa-2048@example.com",
		},
	}

	testCase.run(t)
}
