package keyring

import (
	"testing"
)

func TestPEMRSA3072(t *testing.T) {
	testCase := &pemKeyTest{
		privateKey: `-----BEGIN PRIVATE KEY-----
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
VRIIz51A/c/wq2GSKDCj/Yoo
-----END PRIVATE KEY-----`,

		publicKey: `-----BEGIN PUBLIC KEY-----
MIIBojANBgkqhkiG9w0BAQEFAAOCAY8AMIIBigKCAYEAp0T+YqzMjj5np8uzBIpc
Y/kREEowd63DJps1Em54QnyQ4QZu2HhOHHpajzdskTPsCSg/0m/cCy4tcjNfCcsX
vlm7rAu/pwGG+eXbpHfJtyiN0TeN1o/5VYyFi3aQgbthjvdhyQcK4J1x0LAB5UZb
9dUQ6a5x1N+7C4QqU1fCSP9hzzbxKsCAZnkxWsRn5Y6xLDyTs8YfZr17MwB8JDN4
1ixvcSMaxl5SlEmV5J5Lq6skqTHrVq9akCBfKl1MTjyGhcadMigbwCCi0eWkvIoM
9x4TeQHThCW6NfDp9zOjBp7Cdh2goGhNqHdNIRzPb2eLx5grJ3gsSSfr36Flpn+L
x4WyhSOQ9eYa+nO/CUji9FZohdool5c0DwOXk7tfNvTi4ExFRkWiuucEzHtFx9ap
WsUgDY/NeMGjQYPpEBk9AMObaPCD/D7YW+RoPLRvjcVjG5UEw3C9nZMa4aSWLzIc
chg6gXOVLYbCXb6TqYkmLcs+PuVDILkbWDb17YCbL96fAgMBAAE=
-----END PUBLIC KEY-----`,

		keyTest: keyTest{
			jwaSignatureAlgorithm: "PS512",

			jwkThumbprintSHA256:  "aG0XMbFZ6cEfJYIxczcupgpekyStGYm1YinaPPmhzXA",
			sshFingerprintSHA256: "SHA256:l7kzwR6mASWgwFVgJRDyn9U9FLI7+zq5ZnO+KRj2b1c",
		},
	}

	testCase.run(t)
}
