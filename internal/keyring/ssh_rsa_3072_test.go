package keyring

import (
	"testing"
)

func TestSSHRSA3072(t *testing.T) {
	testCase := &sshKeyTest{
		privateKey: `-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
NhAAAAAwEAAQAAAYEAv1hOBKZ1a10mcADWXfdRayU9arJuw7+BkUe7396oBXlN2BaSie2H
gHC1VP3y8McwJ8gF3JkigpNpEf5jk9eDj/kzocx0hJFpK5aIpXHGVrnsDFpbZR3Nc5QIAs
O3hW6ZXuKGN2cKThc8CQMwr362z4Tw/A3PUzAWKvj6tquELXsNrSTp2j+/1BLsrOizTamH
6C2FfY2QJ7kZg405vZagG9qX3v5CjTGVIZ/pGQlSGMzBteej1mAgdB64Ah59IgxFS5CIUJ
Dt2vVPZLH9OTk5e+9ZbuXQndKHdeaKRcCTtYMIrP2Nv9gwVnbjjQiAE6/E4ZD1Tc9savqI
OesyT7GCIzPTAses5Pviun8n158d6BlzM1+uQUvR7zIDIiRhhf8+j35w0ER/vzaX0Yqau8
ZGnb0MKC8b3jJozn84MbHhVegWc6yj3BhpsAnvFOf9kzFuKXc05lJvLCw79x3bRKJukwcE
lVTQgEZwqVaLJFXp+iwHpeSNZu16eyldjSbGio9tAAAFkDpwCOo6cAjqAAAAB3NzaC1yc2
EAAAGBAL9YTgSmdWtdJnAA1l33UWslPWqybsO/gZFHu9/eqAV5TdgWkonth4BwtVT98vDH
MCfIBdyZIoKTaRH+Y5PXg4/5M6HMdISRaSuWiKVxxla57AxaW2UdzXOUCALDt4VumV7ihj
dnCk4XPAkDMK9+ts+E8PwNz1MwFir4+rarhC17Da0k6do/v9QS7Kzos02ph+gthX2NkCe5
GYONOb2WoBval97+Qo0xlSGf6RkJUhjMwbXno9ZgIHQeuAIefSIMRUuQiFCQ7dr1T2Sx/T
k5OXvvWW7l0J3Sh3XmikXAk7WDCKz9jb/YMFZ2440IgBOvxOGQ9U3PbGr6iDnrMk+xgiMz
0wLHrOT74rp/J9efHegZczNfrkFL0e8yAyIkYYX/Po9+cNBEf782l9GKmrvGRp29DCgvG9
4yaM5/ODGx4VXoFnOso9wYabAJ7xTn/ZMxbil3NOZSbywsO/cd20SibpMHBJVU0IBGcKlW
iyRV6fosB6XkjWbtenspXY0mxoqPbQAAAAMBAAEAAAGABkZp1paz6pe1Mz6fyRibg7FGtJ
lR7xr4b5CD7YlShs1t21yQJTRUOYbYt4cVgMZzgpZ5dLzT6CbX7wZh8x8B+kaApjl7h75y
DcMjy5Mx3zW9M0GCVkxWKMhtw9Nx0Q8pufYhUy9Oo/V4m04Oum6kJaWVNproVfDRhUrBhB
yXWtt6fRdlEOp+ysBtIRWHjdA1vAxEILQ0Ck10c/89acWHDirKyL4bZiB+ZMom/ZJz7grG
/oVwds8TuWMpgy5HScbPr07Ryqsdhf9FeFZie0rYNy25aC0AltIGSmlkOu12Emi+GEhi5J
C6+syvDX5NdYCgIRNcAA5uUzt6qm2Z9yIU0z4xqcc7uYZH83Uq27vGxIksnfq/1vehQ6Hx
mMzd4KUqDsiEk2XXbb8YPuRYCSaI1bwDnJceG+8heY9YzxRAngT4+cr1m3zOZbsj9kXOgs
8xc6t4R+Aj4dD0oa2lnFcrvhr9fA0iyKM3MCjy1WAOV8BGEiPyzjlv2OhUE614OwCxAAAA
wEoYJJw4vUG8VlojKz74TaOwrUzCLk4eYeV5HG4/hqx2ZujpEWh3anJ0b0MMpJnQPBUfMM
+30qdC4l2uBEAyzTU36bOKpNxQfLB67siYDfCvBR2ulG80CSmODHrvqJoX4zlnqvT+I3al
g4/L3tknwbPBm6+5/N2DVHPou0eGX1U9cTE0UrMVNRIJBHCtUiT1H0MaBLqeHO9f3GVllD
C4tzmWyh5XhjkQrtjUIjcNxbiRV1FQjes7M+qJhXdYtFGTZQAAAMEA/U127sLV3KScv1pm
DTRAQLPrRIWylllIsAb3tdX2mQNGBWcY2QzA6ix2/SrZbaaJFh4vZrrErT4T2aeUG+uHk2
F3ik+MjtDbCQ66A9B1oUR7klpTasAgcGqfcG9ctP0EP2+xUnPYznLNJlgh808o66d/Kh5z
ANbIROi7xFCBNyms1isZlzH5NlAKzEYhEC6oYw0VWxNSq6oZx8CBznVTj3B3f4ByyLOVmw
7iDBHliD7fGxQj82Jxn4cqS4iKE6EdAAAAwQDBYe+GrluEIacb4A3YZOqycKIUh4L3peYS
h4/nWeS+EN4Ed45eCkp3FKIU11BgKs6qMBdqJB/Bki6lu9gAuoTuNxO9NXQSJ6NnGX/qEK
UVQjvU6Oik4T9LtwOaEV5TwheJ2O0uQi+UmYISbRzrTAd6p+W3yrewGMlmUoTVW3TA5zVx
Us0B8Kq3a9nP8MTD17Zlb/7OhikLLFmOSwBtavG1gz6OYrlH92gJ8iOuay3UVAg+V6O0uk
iSPXazz3/qJpEAAAAUcnNhLTMwNzJAZXhhbXBsZS5jb20BAgMEBQYH
-----END OPENSSH PRIVATE KEY-----`,

		publicKey: `ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC/WE4EpnVrXSZwANZd91FrJT1qsm7Dv4GRR7vf3qgFeU3YFpKJ7YeAcLVU/fLwxzAnyAXcmSKCk2kR/mOT14OP+TOhzHSEkWkrloilccZWuewMWltlHc1zlAgCw7eFbple4oY3ZwpOFzwJAzCvfrbPhPD8Dc9TMBYq+Pq2q4Qtew2tJOnaP7/UEuys6LNNqYfoLYV9jZAnuRmDjTm9lqAb2pfe/kKNMZUhn+kZCVIYzMG156PWYCB0HrgCHn0iDEVLkIhQkO3a9U9ksf05OTl771lu5dCd0od15opFwJO1gwis/Y2/2DBWduONCIATr8ThkPVNz2xq+og56zJPsYIjM9MCx6zk++K6fyfXnx3oGXMzX65BS9HvMgMiJGGF/z6PfnDQRH+/NpfRipq7xkadvQwoLxveMmjOfzgxseFV6BZzrKPcGGmwCe8U5/2TMW4pdzTmUm8sLDv3HdtEom6TBwSVVNCARnCpVoskVen6LAel5I1m7Xp7KV2NJsaKj20=`,

		keyTest: keyTest{
			jwaSignatureAlgorithm: "PS512",

			jwkThumbprintSHA256:  "oLsz_aHqDezAGxmRWIgy1Nrooo0tg360nay6F65eXbs",
			sshFingerprintSHA256: "SHA256:YkgzrlM90uzgTuTSGIJtmAI5ygfKOMRwJ9WrTKPlxHE",
			comment:              "rsa-3072@example.com",
		},
	}

	testCase.run(t)
}
